package ch.hallo02.adventofcode.year2023.day12;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

import static ch.hallo02.adventofcode.year2023.day12.Day12_1.Spring.*;
import static java.util.stream.Collectors.toList;

public class Day12_1 {

    // yes 7260
    public static void main(String... args) {

        var r = puzzle.lines()
                .map(Day12_1::lineToRow)
                .mapToLong(Day12_1::countPossibleArrangement)
                .sum();

        System.out.println(r);
    }

    static long countPossibleArrangement(Row row) {

        var numberUnknown = row.springs
                .stream()
                .filter(e -> e == UNKNOWN)
                .count();

        List<String> combinationBitString = IntStream.range(0, (int) Math.pow(2, numberUnknown))
                .mapToObj(i -> (String.format("%" + numberUnknown + "s", Integer.toBinaryString(i)).replace(' ', '0')))
                .toList();

        int possibleArrangements = 0;

        //System.out.println("number unknown " + numberUnknown);
        // for every bit string
        for (int c = 0; c < combinationBitString.size(); c++) {
            //System.out.println("combination bit string " + combinationBitString.get(c));
            //patch
            List<Spring> candidate = new ArrayList<>();
            // for every spring in row
            int numberUnknownInRow = 0;
            for (int s = 0; s < row.springs.size(); s++) {
                var spring = row.springs.get(s);
                if (spring == UNKNOWN) {
                    candidate.add(combinationBitString.get(c).charAt(numberUnknownInRow) == '0' ? DEFECT : OPERATIONAL);
                    numberUnknownInRow++;
                } else {
                    candidate.add(spring);
                }
            }
            //System.out.println("Candidate: " + candidate.stream().map(s -> s.toString()).collect(Collectors.joining()));

            // check
            var regex = "(#+)";
            Pattern pattern = Pattern.compile(regex);
            var candidateString = candidate.stream().map(Spring::toString).collect(Collectors.joining());
            Matcher m = pattern.matcher(candidateString);
            List<Integer> countDefect = new ArrayList<>();
            while (m.find()) {
                countDefect.add(m.group().length());
            }
            //System.out.println("countDefect " + countDefect.stream().map(x -> x+"").collect(Collectors.joining()));

            if (countDefect.size() != row.checksum.size()) {
                continue;
            }
            //System.out.println("equal error array length");
            boolean validCandidate = true;
            for (int check = 0; check < countDefect.size(); check++) {
                if ((int)countDefect.get(check) != (int)row.checksum.get(check)) {
                    validCandidate = false;
                }
            }
            if (validCandidate) {
                //System.out.println("is valid");
                possibleArrangements++;
            }
        }
        return  possibleArrangements;
    }

    static class Row {
        List<Spring> springs;
        List<Integer> checksum;

        Row(List<Spring> springs, List<Integer> checksum) {
            this.springs = springs;
            this.checksum = checksum;
        }

    }

    static Row lineToRow(String line) {
        var springs = line.split(" ")[0].chars().mapToObj(c -> {
            if (c == '.') {
                return OPERATIONAL;
            } else if (c == '#') {
                return DEFECT;
            } else {
                return UNKNOWN;
            }
        }).toList();
        var checksum = Arrays.stream(
                line.split(" ")[1].split(",")
        ).map(e->Integer.valueOf(e)).toList();
        return new Row(springs, checksum);
    }


    enum Spring {
        OPERATIONAL("."), DEFECT("#"), UNKNOWN("?");

        String sign;

        Spring(String sign) {
            this.sign = sign;
        }

        @Override
        public String toString() {
            return this.sign;
        }
    }


    static String miniPuzzle = """
            ???.### 1,1,3
            .??..??...?##. 1,1,3
            ?#?#?#?#?#?#?#? 1,3,1,6
            ????.#...#... 4,1,1
            ????.######..#####. 1,6,5
            ?###???????? 3,2,1""";

    static String puzzle = """
            .??.?#??##???. 1,6
            ?#???.#??#?????.? 3,1,3,1,1
            ??#????#??#???.?? 4,7,1
            ??#?.?#?#???#?#?? 1,11
            ?????????? 1,4,1
            ?#?#????..?????? 6,4
            ?#?#?.#?#???????..? 5,1,1,3,2,1
            ?.#??#??.??????.? 6,1,1,1
            ##???###?.##?? 2,4,2
            ???.#??#????.??? 3,7,2
            ????#??..?# 1,3,1
            .?..#????????#????? 1,5,6
            ?#..??##??.??? 1,5,2
            ?#???#???# 1,1,2
            #???#??..?????.??.?. 5,1,1,1,2,1
            ??#??.?#??????. 2,2,1,1,1
            ??????.???..??#?? 1,2,1,4
            .?#??#???#??#?????. 12,3
            ??#???#?.?##?.?? 6,3
            ?#?#?.??#???? 3,1,1,1
            ??#???.#??.#. 3,2,1
            ??#...??.. 3,2
            #?#.??????#.??????? 3,2,1,1,7
            ?#?#.?????#???? 3,5
            ?#??.???.?.?.???? 4,1,1,3
            ????????.##?#.???? 2,1,4,2
            ?#??#.??????????#? 4,3,1,3
            .#?#?.???..? 3,1,1,1
            ?..##.???#????. 2,2,2
            .#??#?#??#?.? 9,1
            ???.??..?#??#?? 1,1,2,1,1
            .??#??#..#????? 2,1,1,2
            .???#??..??????####? 4,2,7
            ????#?.??. 1,1,2
            ?#??#?#?..???#?.?.?# 1,5,1,1,1,2
            ??????#???.?.??.?#?? 10,1,2,1,1
            ???.????..? 2,1,2
            ??.#???????? 1,1,4
            ??.??#???.?????#? 1,1,1,1,6
            ?..????##.##?#?????? 6,6,2
            ##???#?.??#.???? 7,2,3
            ????#??#??#? 1,6,2
            .???.??..#..?#??? 1,1,1,1
            ?.???.?.???????? 1,1,1,3,4
            ?.?????#?#.?????#??# 7,1,5
            ?????##?#?? 2,6
            ???.#?#????#. 1,5,2
            ????...?#?? 1,2
            .????.?????#. 2,3
            ?.?????##??###?##??# 1,1,11,2
            #??..?#?.???#??. 2,1,3
            #?.???????#???#. 2,1,1,1,3
            ?#???..#?? 5,3
            ????#???#.?#???#?.#? 2,2,1,1,4,2
            .????#??##???#?#. 8,4
            ???????????#?.??#. 2,1,4,1,1
            ?.#?#??.??####??? 5,8
            ?#?#?#???.#.?#. 8,1,1
            ?.??.????#?.??.? 1,5,2
            #??.?#...? 1,1,1
            ??#?#???#??#.????.?# 8,2,4,1
            .?#?####??? 7,2
            ???#??#?.??? 4,3
            ..????##????????.? 8,2,1
            ???#?#?##?.???.? 7,2
            ?#???#?#.?.??#.?. 6,1,1,3,1
            ???.?#?.?? 1,1,1
            ???????#..# 4,2,1
            ?.?#.?????? 1,1,2
            .????????#???##?#? 4,1,4,4
            ???#?#?????#?#?? 1,13
            #????#????.#?#???#? 2,5,8
            .????#.#??. 4,2
            ??#????#??? 8,1
            ?.##.??#??? 2,4
            #????#?#?#?.?????#? 1,1,1,4,1,3
            ????#????.?????##??? 2,5,1,1,2,1
            ..???#??..?#? 6,2
            ?#?.?.##???????? 3,1,2,4,1
            .?.???##?????# 1,5,1,1
            ?.#????.??? 2,1,1
            ?#?#?#.???..???.??? 5,1,3,3
            .?.???#??#?.???#? 1,6,4
            ?#???.?#?#.????#? 5,4,1,2
            .?#????????...#??? 2,2,4,4
            ?????.???#? 1,4
            ????#?.????.?#??.??? 5,1,2,1,3
            ????????.? 2,2
            ..??#???#?#.?#? 9,1
            ????????#????#????? 5,3,1,1
            #?????#??????. 1,1,3,1
            ?..#?.#???? 2,4
            ..#?????????#?#???? 1,13
            ?.?#.???#?? 1,2
            #?.#??????????#? 1,2,1,2,3
            .???????.?#.?? 1,3,2,1
            .????.?#?????##?? 3,3
            ????###?##??.??#???? 1,8,5
            #?.?####????.? 2,6,1,1
            ??.##???#?????? 1,6,2
            ??.??#???#?#? 1,3,1,4
            .??.???.?#?#??? 1,2,5
            ??.#.?#???.##??? 2,1,1,1,5
            ???.???.??.?????#? 1,1,1,1,3,2
            ?#?.?#?##???#???#??? 1,11,2
            ??#????.?. 1,1
            .?#??##??#???.?? 10,1,2
            ?#?#?.?#.? 1,1,2
            ????#???????#. 3,1,1,1
            .??#?..??.???.??? 3,1,2,1,1
            .?#??.???#? 2,1,1
            ?.?#.??##?????????? 1,1,8,1,1
            ?.?????.??#?? 4,1,1
            ?.??.#???? 1,4
            ???#???..???.? 2,1
            .??????#?#??.?.? 2,5,1,1
            #??#??..?.?.???.#?? 6,1,1,3
            .???.?#?#??.??#???? 3,1
            .??#?..???? 4,2
            ?.##???#???#??#.?? 2,8,1
            ????#.#.???.???# 1,1,1,2,4
            #???????????.???#.? 6,1,3,1,1
            ?#?????.??##??. 1,1,1,1,2
            ?..????..?#? 1,1,1,3
            .??..????.?#?? 2,1,1,3
            ????????????. 1,1,7
            ???.?.??????#.?? 1,1,1,3,1
            ?##...?..##??. 2,3
            .???##?????? 1,5,1
            .??#?.??????#???#?? 4,7
            .?#???.?.?? 4,1
            .???###???#??..???? 8,1
            ???.?????#??##?.. 3,5
            ??##??#??????? 5,2
            .?.???.#..? 1,1
            ??##.??#??#???. 4,6
            ?#????#..##?#? 1,3,4
            .?.?.??..? 1,1,1
            ??????????#??#. 1,1,1,1,2
            ??##???.???.????. 1,5,3,1,1
            ???????.?????#?##??? 7,9
            ##..#???.?#???#?? 2,1,1,4,2
            ????#??#??????? 8,1,2
            .##?##???????.???# 7,1,2,1,1
            #.?..????#?#. 1,1,1,5
            ???#??#????.??? 2,1,1,1,1
            #.??#.???#?##?#????? 1,1,1,3,4,2
            ???###?#?.???.??? 6,2,1,3
            ???#?#???????? 8,1
            ??????.#???.?..??.? 3,1,3,1,1,1
            ???#?##??#?.??.#.?? 1,8,2,1,1
            ??????##???.#??#?? 8,2,3
            ??.??#??.??.# 2,1
            ??#.???#??????#? 3,3,4,2
            #?..???????#??#???? 1,5,6,1
            .??####??.???. 5,2
            .??#???????#? 1,1,4
            .?????.#?#???#?# 1,1,3,1,3
            .??#??#???..#.?.?# 1,1,4,1,1,1
            ??.??????????.? 2,2,3,1
            ???#.?.???##?## 4,8
            .?###??????#??#??? 5,7,1
            ??.???.??#????#??? 2,2,1,1,5
            #???????.?#.#???### 3,1,2,1,3
            .????#???..?.#?? 4,1
            ???????????.?#.?? 3,2,4,1,2
            .??#.#?.?.??##?.? 3,2,1,4
            ??#??.?##???#? 2,3,2
            ?????###?.? 2,5,1
            #?#.?##????#???? 1,1,3,1,5
            ???#??#????????## 9,2
            ?#??##??##???##??.?? 2,11,1,1
            ???.?#.???? 1,1,1
            #???#????????.#? 1,4,1,2,1
            ?#??.??##? 2,4
            .###??#??#??#?# 3,10
            #.????#?#??????#?? 1,2,4,2,2
            ??..????.? 1,1,1
            #??##?..??????? 5,1,1,1
            ##????.?.##???. 3,1,5
            ???##.????#? 5,1,3
            ?.????.##.? 1,2,2
            ?#????##??????##???? 1,2,3,8,1
            ???#?????.?..? 3,1
            ?#?#??.#??#?.? 5,4
            ??.?###??????? 1,4,1,1
            ..##????#???#???? 4,6,3
            ?????#??????.???# 7,3,1,1
            ??#???????. 3,1,1
            ??????##??????. 1,1,2,1,1
            ?????.??????. 1,1,2,1
            ?.?.??.?#?????#?##.# 1,1,1,8,2,1
            ?.#???????#?? 2,1,3,1
            .#????..??#?..?# 4,1,1
            .??.??#??? 1,1,1
            ##??###??.??? 8,1
            ????#???????.????? 6,1,1
            #?#??#??..????? 1,2,1,1,5
            .?#????.?.??#? 6,1,1,2
            ????..?##.?.?.????#? 4,3,1,1,1,3
            .#???????##??.???#?# 5,6,4
            ##??????#?..#??? 2,1,5,1,1
            #????????#?#.#?.? 1,1,1,4,1
            #??#???#.?????#???? 8,1,1,5
            #?.?#??#?.? 1,2,2
            ?.#?#??.?????..? 4,3
            ?#?#???.?? 4,1,1
            ???????#????#???.? 1,2,2,2,4,1
            ????#??..?.??#?#?. 5,3
            ..??#?#????????#???. 5,1,3,1,1
            ?.#???.???. 1,2
            ??????????.?.??? 6,1,1,1,1
            ?#??????.? 3,2,1
            .?.##???## 1,7
            ?.?????#??##??##???? 1,16
            ??#????##?#??? 1,1,7,1
            .?????????? 5,1
            ??????????.? 2,1,1,1
            ##?.?????. 3,1
            ?#?..?.???? 2,1,1
            #..???#??#???# 1,2,8
            ??##?????#????? 3,9
            ???#?.?##. 3,3
            ??.??#?#??##?#.# 9,1,1
            #.??#?#??. 1,3
            .??#????????????? 3,1,2,3
            ??#??#???.?.?? 7,1
            ??#..##????#??#????? 2,10,2
            #?###????##?..??? 11,2
            .???#.??#.?##.?? 1,1,1,3,1
            ?#??????#? 5,1,1
            ?.?##??#??????? 5,4
            .?????.?#??.. 2,2
            .??.?#####?????##? 7,4
            ??????.#?.. 1,1,2
            ??#??????..?? 3,1,2
            ??????????# 4,2
            ?.?######???. 1,7,1
            ????#?????????# 10,2
            .???#?#?#? 1,2,4
            ?##????.???#?#?? 5,5
            .??#??.?#?#?.##? 1,4,2
            #.????????#????. 1,6,2,1
            ?###????.?#?#??#??.? 6,9,1
            ?..??..??###. 1,2,5
            ?????#?????????.??. 1,1,3,6,2
            ?.?#??.??? 1,1,2
            .??.?????????. 1,5,1,1
            ????#??.?????## 3,6
            ##?#??.?????. 4,1,1,2
            ??#????#??.????#?. 8,1,2
            .???????#.?.?#??#??? 1,2,2,1,7
            ?#.#???.?#?????# 1,1,1,1,5
            ??#?##?.??# 6,3
            ??????.##??#??###? 1,1,1,5,4
            ???#???????##??. 2,1,1,2,1
            ?????#..????#??##? 6,1,3,3
            ????#??#??#??????##? 11,3
            .##??##?????.#?#?? 11,1,1,1
            ?.?#?.?????.?? 3,4
            ###?.????#?? 3,1,3
            ????..?##?.??????#?? 3,2,9
            ?#?.???#??#. 2,1,4
            ??##?#?.#.???#??? 6,1,1,1,1
            #??????.???.#?#??. 4,2,1,1,3
            .?#???????.##? 7,2
            ???#???.?.?#?#?. 4,1,5
            ?.?????#.??#???# 6,3,1
            .??#??#??.?#??? 6,1,1
            ??#????????. 5,1
            ????????????? 1,4,1
            ?#??#?####?.??.?#... 10,1,2
            #????#??????#???.?? 1,1,4
            ?.???.???### 1,1,1,4
            ?####??.?.??????. 7,4
            #???.#?#?#?#.?#?? 2,7,2
            ???..?.??#???. 1,1,6
            ???????.????####??.? 4,1,10,1
            ??.?#?????????..?.# 2,11,1
            ???.???#??.. 1,1,3
            ?.?#?#??#????#?? 1,2,2,3
            ???#????.?#??. 3,1,1,1
            .????????? 1,1,1
            ?.?.????##?###??.?? 1,11,1
            ?#????.#?#??? 1,1,1,2
            #.?.?..#?#?#????? 1,1,3,4
            ?#?.??..?##?##????? 3,10
            ?????????#????.#???? 1,7,1,2,1
            ?#????????.#?# 1,4,2,3
            .????????#?. 6,2
            ?.?#.??##.#??.?#?? 1,2,1,2,1,2
            .?????#??.?#?? 2,3,2
            #?.##?..#.???????? 2,2,1,5
            ?????.?#????? 1,1,1,3
            ???????#?##??#??? 1,10
            ???##?..#? 1,3,2
            ???#???.???.?? 2,1,1
            #?.#..?.?? 1,1,1
            ????#???#?. 2,6
            ##.?.????#??.?#?## 2,1,1,1,1,5
            ??...?#??##.#???? 2,5,1
            ??????..?#???? 3,1,1,1
            ?#?.?##???#?.???? 1,8,1
            ???##?#???????.#? 5,6,1
            ?????..?#????# 1,1,2,2
            ?###..??#? 3,4
            ..?#??#????# 5,3
            ???.???#????. 1,1,6
            ??#?.??#?.???. 1,3
            ?..????...?.????? 4,1
            #.??#??#?.#??#??#?# 1,6,1,7
            ?.????..?.?? 1,3,1,2
            .??#???#??????#?.?# 1,1,10,1
            .#.?.??#?.?.#?? 1,1,2,1
            ?.?.??.#???#? 1,1,1,3
            ?.???.???.?? 1,3,2,2
            .????.??????. 1,1,1,2
            ?.?#??????.??#? 1,5,1,1,1
            ?????????#. 1,2,1
            .?.?#??##???? 1,6,1,1
            ?#??#??.#? 1,1,1
            ??.???????#??#.? 2,1,1,5
            #?.#??.?.##..##?.?. 1,3,2,3,1
            ????????#?.##?#? 2,1,2,5
            ?#?????.#?#.??#? 3,1,1,1,1
            ????#?#?????#? 2,3,4
            ?.???????#. 1,3,1
            ???????##?#???.????. 14,3
            ??????#?.#?#?? 6,4
            ?##?#.??##?.# 5,4,1
            #??.???###?????? 3,1,3,1,1
            ?#?#??.???#?#??? 5,2,4
            .???#?.#?####. 1,1,6
            .???.?#?#??.# 2,1,2,1
            #.#??#????? 1,6,1
            ?.??.???.. 2,1
            ?.??.#?##.?????#???. 1,4,8
            .#?#?#?#???..?#??# 9,4
            .#.?#?#??.# 1,6,1
            #?#.???#?????? 3,1,7
            ??#?###??#?#??#??? 1,6,1,1,2,1
            ??.?##???#?#?.? 1,10
            .#?##???#???##???..# 1,11,1,1
            ??.#?.????#???# 1,1,7,1
            #????????#? 1,6,1
            ????.#?.??#???#.?# 1,1,1,4,1,1
            .???#?#??.?.???# 7,4
            ???##??????..## 8,2,2
            ?#?#?.?.?##?## 5,5
            ?.?..???.. 1,2
            .?.????..# 1,3,1
            #??????#??.?#?###??? 1,1,1,1,1,8
            .??#??.?.???? 4,1
            ??????##?.. 2,3
            ?#.????.#?# 1,1,3
            .?????..?????#. 2,1,2
            ????#?#?##.????? 10,1
            ?????.????#?? 3,1,1,1
            .??????.??.??..? 6,1
            ?????????#??#???# 1,2,3,5
            #??####??..??#?.. 9,1,2
            ?####??##?.????? 9,1
            ?##??#??.???#. 6,4
            #.#?????????.#????? 1,1,1,1,1,5
            ??#???????###??#??? 5,8
            #??##?????#????#? 1,7,1,1,1
            ????????#?.????.???. 1,1,3,1,3,3
            ??.??????? 1,2,1
            .?####???.???#?.? 4,1,3
            .???##??#?????.???? 13,1
            ???.??#??#?????????? 1,1,3,7
            ?????..??.?? 1,1,1,2
            ?#???#??#??#???.??? 7,6,1
            ???#???#?#??????. 6,1,2,1,1
            ???????.?????? 1,3,2,1
            ..#???#???#????#? 1,10
            ??##??##???.???# 6,1,1
            #?#???###?##?.?????? 1,1,1,7,1,1
            ??#?.?#?.???? 1,2,2
            .?..???#.? 1,4
            #??????#.?#?.##???## 3,1,2,7
            ...#??#??#?##??.. 10,1
            .#??.??????????? 3,2,1,1
            ?#??#?#?#????###??. 2,15
            ?#????#??.?????? 2,4,6
            ??.??.????##. 1,1,1,4
            .??#???.?.?????? 4,1
            ?#??.??##??#??.? 2,8
            ????#?#??#???##????. 1,15
            .???????#..?#?? 2,4,2
            ?.?#?#?.#.?.??? 1,2,1,1,1
            ???????#?##?#??? 1,6,2,1,1
            #???#####?.???#??. 10,4
            ??????#.?????.? 2,3,4
            ?.?#?#?????.? 4,1
            ?.#?#?..????????#. 1,4,1,3,1
            .?????????#??##?? 3,1,7,1
            #.?.?.???##.??? 1,1,1,2,1
            ?#.??##??.?..#? 2,3,1,2
            ?#.?.????????#? 1,2,6
            ???#?.??##?#???#??. 1,2,1,10
            ???????.?#????? 6,3,2
            ????#?.????.??.? 1,2
            #???.??#.??? 1,1,3,2
            ???.??#??#????? 1,2,3,1
            ?#?#????#?.?? 2,1,4,1
            .#???????#??#? 3,1,5
            ?#.???.#.????#? 1,2,1,5
            .???#???##.??????.# 6,2,1,1,1,1
            .??????????? 1,1,4,1
            ..??????????#?#?#?#? 6,10
            ???.#????#.# 1,3,1,1
            #???????##?#..?? 1,1,5,1,1
            ??#???#?#?.??...??# 10,1,2
            ?#???#??..?????#???. 7,3,2
            ???????????#??. 1,2,1,1,1
            #????#???##??.?.?#.? 1,11,2
            ?????.??.???.?# 5,1,3,1
            ?.#?#?#?#?#?#??? 1,1,1,3,5
            ??.????.???? 2,3
            ???????#??#? 1,3,2,1
            ???.??#???#? 1,4,2
            ??.??#?#.#????? 1,1,1,2,3
            ???#????.?????.?.??? 5,1
            ???#?.???##???####. 2,10
            .??#..?.???? 2,2
            ?#.???#??##??? 1,7
            ?????????##?? 3,1,3
            .?#?#?.?.#? 4,1,2
            .?.?#??.????#?? 1,2,1,3
            ?#?#?????.??#?.??? 7,3,1
            .#???????#????.#..?? 3,4,3,1,1
            ?.?#.????.#??#???# 1,1,1,1,6
            ??##??#???#?#..# 4,7,1
            ????#????. 5,2
            ??#?#?.?.?..??? 2,1,1,1,1
            ##????#?##??? 2,1,1,5
            ??#..?#?##??? 2,8
            ?.??#??????#?? 6,2
            ??.?.???.??? 1,1,1,1
            ?.?????#??? 1,4
            ??#???????#??????? 1,7,1,1,1,1
            ????..??.?????.#?? 2,1,1,1,1,3
            ?#?#??.???????? 2,2,6,1
            ??.??#?????##?? 2,2
            ???.???????????.?? 1,2
            ??##??????#?#??.# 2,1,2,3,1
            ??????#??#? 3,1,1
            ??.?????##????##??? 2,14
            ?#?.?..??? 1,3
            ?.??????#? 2,1,1
            ??.??##.?? 2,2,1
            .??.??.??? 1,1
            .?#????#??. 2,3
            ???????#???.#? 3,2,1
            ??#???..?? 6,1
            ...?#???###????? 2,4
            #?.?.???????? 1,1,1,2
            ?????#????#??.?? 7,2
            .?????#??.???????? 4,3
            ?###??.?.?.?##??#?? 3,1,1,7
            ??#?#?##??...??? 9,1
            ?????#?#?????.?##? 12,3
            ???????????..#??. 8,3
            ?#??#?##???#??? 7,1
            ??????###??## 1,10
            ?#??????#????#####.? 2,2,1,8,1
            .?###???..??#???.? 4,1,3
            ?.???????? 1,6
            ???#??#.??#?##??.? 4,2,7
            ??.#??#??##??#?##. 2,2,11
            ??.??#?#... 1,4
            .?.#?#?.?????#? 1,4,5
            .?????.???#?#?#??#? 4,9
            ??.#?????#?#????? 1,12,1
            ???#???#????.#???? 1,7,1,1,1,1
            ??.?????##?.?..#?#.# 1,1,3,1,3,1
            .?#??##?????###?# 1,7,3,1
            #???????????#????#?? 1,2,1,1,1,7
            ####??##???#??. 9,4
            ???#???#?.??#? 4,3,1,2
            ???..#???? 1,1,1
            ?#????#?.????.??#? 3,1,1,2,1
            .?#????##? 4,4
            ??.???.??? 1,2,1
            .??##??.????#??? 3,1,8
            ????????#? 1,4
            .#????#???????.?.? 6,1,2,1
            ??.??????##??#?#?#? 1,1,8,3
            ??????###? 1,3
            ???#..#??#.??.?#? 4,1,2,1,1
            ?.##??#????..##?? 7,2
            #??#????#?? 5,2
            .#??.?#?#???? 2,3
            ?.??#??##?????.??#? 3,2,2,3
            ?.#???##????.? 10,1
            .##???.#??? 5,2
            ??#?????.?#.???.?# 2,2,1,1,3,1
            ?#?????.#??#???#???? 1,10
            ?##?#..???#??#??#??? 3,1,1,6,1,1
            ?.?????#?????????.. 2,3
            ????#??#????#???. 1,12
            .#?????#????????###? 1,11,3
            #?#??.??###?? 3,1,3
            .#?????.??##???#??? 3,10
            .#?.??#??? 2,1,1
            .???##?..?. 5,1
            ?.??#??.???? 2,1,2
            ?.??.#?.????#?????# 1,1,2,1,9
            .??????#?#????.?#?. 8,1,3
            ?##???????.#. 3,3,1
            #???????#.???? 9,3
            ?#???.##??#??? 4,7
            ????.?#??.?.#?#??? 2,4,5
            .?????#?#??#?????# 7,1,1,1
            #??..???#??#? 3,4
            ???.??##?????##??#?# 3,7
            ?#?#.??.?#.?#.? 1,1,1,1,1
            #.??????????? 1,4,3
            ...???????##??#??#.. 1,12
            .???###????#??##???# 1,15,1
            ???.?.?#?##..#? 3,5,2
            ..??????.??#??. 2,2,4
            ##???#?#?????? 8,3
            ???.???#??? 1,4
            ???.??.?#?????.#???? 2,1,3,2,1,1
            ???#?#??#.? 1,6,1
            ??###?????#?##.???# 10,2,1,1
            ???##???..#??? 4,2
            ?##??#.?#?##? 5,5
            ??????.?#.?.?.? 1,1,2,1,1
            ???.?#?#?.?.? 1,1,2,1
            ???.??#?.?? 1,2,1
            ?#????.?#.??? 5,1,1
            ?.???.??#? 2,2
            ??.??#??????#????##? 1,16
            ????.????.??.?.#?#?? 1,4,1,1,1,1
            .??#??????? 1,3
            ???.?????.. 1,1,3
            #??#?..???#?..?? 4,1,2,1
            ??????#.????? 7,1,2
            ?###???..?#?? 6,2
            ?????????#??#.?? 1,1,4
            .????#????. 4,2
            .?#.?..??#.?##??# 2,1,2,2,1
            #?#?????#??#?.?#.#? 6,1,2,1,1
            ????.#???#???? 2,1,2,1
            ???#????????..#?? 8,2
            ??##?#???.?#?..???. 6,3,2
            ????.??#??#.?#??? 4,6,3
            ???##??##?? 5,3
            ???????.#..#???# 3,1,1,1,3
            ?????????? 2,1,1
            #??#????#?#?????#? 11,1,3
            #??#??#?.???##??? 1,2,2,7
            #?.???#?##?##?? 2,1,9
            ..??..??..?? 1,2
            .????.?#?#?.?. 4,5
            #???#??#???.???#??? 2,4,1,1,1,1
            .??#..??????#???#?. 3,1,9
            #???????#.????? 2,1,1,2,1
            ??????##????#??.??. 8,1
            ???.??#?...?#?#? 3,4
            ?.??.#??#? 1,1,4
            ?.??#?#??.??? 1,4,2
            ?##??#??.????.??? 6,1,4,1
            ??.?????#??? 1,3,1,1
            ?.?????????#?#??? 5,8
            ?.?????.#?##?. 1,1,1,4
            .?????##?#??.? 11,1
            .?.??#?????????# 1,1,1,5
            #?#????..?#??#??? 6,5,2
            ?#??#??#?#?.???#??? 10,2,1
            .??????#.? 4,1,1
            ????.?#.????? 2,1,4
            ???????.?##? 2,4
            ?#????#???? 4,4
            ?.?#.???.?## 2,1,3
            ?.????#...???..??. 4,1,1
            ?#???#????#. 8,1
            ?#.??????.?####?. 2,2,2,5
            ??#?????#.?? 5,3,1
            ?#????#??????#..?# 7,4,1,1
            #?????.???#?##?? 1,1,1,2,4
            ##?#????.???. 8,1
            ?.???????##??? 3,6
            ???????##??#???. 1,7,1,1
            #?????#?.??##??????# 1,5,7,3
            .???????.# 2,1,1
            ??????.?#?? 3,2,3
            ??????#????. 7,1
            ??#?.??.??? 3,2
            ..??????#?#???#.? 9,1
            ##?#??..#.? 5,1,1
            ?#??#.????.???? 4,1,1,1,1
            ?????#.#.?.??? 2,1,1,2
            ???###?..??. 4,1
            ??####?#?????#? 7,1,1
            ??###?#???.#???????? 9,1,2,2
            ??.??.?..####?#??? 1,6
            .???#?????????????# 3,2,1,1,1
            ??#.????.????????? 2,3,5,1
            .?..?#?#??????#??. 1,10,1
            #?.???#..???. 1,4
            ?#????????#?.. 5,5
            ???#.#??#?##???##. 3,7,4
            .??###?#?.?????..?? 6,4
            ???.???##???.??# 3,1,5,1,1
            ..????.???? 2,1
            ?#..?##??.#??#? 1,4,2,2
            ????..??#?#?? 1,1,2,3
            #???.???????? 2,4
            ..??????#??.???.??? 7,2,1
            ?.#???????.. 3,2
            ??????##????? 9,2
            ??.#.??.?#???#?# 1,1,3,3
            ????.#.???? 3,1,1
            #??.?##??#??#.?? 1,1,9,1
            ?.????..??.???? 1,3,1,1,2
            ??.???##??.#????? 1,5,4,1
            ???.??.?????.?.???# 3,1,2,1,1,4
            ?#.#???..??#??#? 2,1,1,4,2
            ?.??.?..?????.???. 1,1,1,5,1
            .?#???.??.????????? 4,1,1,3,1,1
            ???.?#.???. 2,1,3
            ???.?#??????# 1,3,1,2
            ????????.?????. 5,4
            ??#.??.??? 1,1,3
            ??#?..?#???#?.? 3,4,2
            ????#??##???????? 7,1
            #??????##?.## 1,1,3,2
            ???#.?????# 3,4,1
            #?#?.??????# 1,2,3,1
            ?.??#..#..?? 2,1
            ?????????.?????..? 7,1,1,1
            ?????.???.??#??.??# 2,1,1,1,3,2
            ?.?.??#?.#?# 1,1,1,3
            ????????#.? 6,1
            #.????##???????? 1,5,3,1
            ..???#.?.#?#??#??# 4,1,4,1,2
            .?.#?.??.??? 1,2,1,2
            ??#??.?#???.. 2,3
            ???#??#????#? 7,2
            ??##?.??#? 3,4
            ?.????#????.#?#? 1,2,3
            .???.???#?#????? 2,5,1
            .##.??.#.##? 2,1,1,2
            ??????#??????##?.? 1,4,3,4,1
            ???????#???.?#?# 6,4
            ??..?????????.#??#. 1,8,1,2
            ????????.? 1,2,1
            ??##??##???#?.??#??? 3,6,6
            .??#?#???????? 3,2
            .??????.??##???..? 5,4
            ????????..? 2,4,1
            .#?????#?#??????? 1,9,2
            ?#####??#???.#?? 7,1,1,1
            #???.?#.#.?#?#?###?? 1,2,1,1,8
            .?#?????.??????? 6,4
            ????.?.??##.????#?. 2,1,3,1,2
            ???????????????#. 5,1,4
            .?..?.?##????? 1,1,4,2
            ..???????? 2,2
            ??.??#?#.? 1,5
            ?#???.#####??? 3,5
            ??..#?#?#???#??? 1,3,8
            .????????.???#? 2,1,1,1,2
            ?????.#???????#.#. 1,2,1,2,1,1
            ????#???#??#.?? 6,5
            ??.?#??#??#?.??#?#?? 5,2,4
            ???###??#?#????. 8,5
            .??????##.????#??.# 1,5,1,3,1,1
            .?????..?????? 1,1
            ??##?.?.?? 3,1,1
            ???#??###??????##??? 1,6,8
            .????#.???????.?#?#? 1,1,1,6,1,1
            ???#..?#.?.?? 4,2,1
            ?.?.#.?#?## 1,1,5
            ?#???.?#?? 4,2,1
            ?#?#?#???#?.??#.??# 5,2,1,1,1
            .???#?.?##?? 1,5
            ?#???.?#.? 4,1
            .##??#?#...?? 7,1
            ?##?.?.?.?#?..??. 2,3
            ??#?#.??#?????? 4,2,2
            ?#?###?.????.? 7,1,2
            #?.#?#?.?#?.#? 1,4,1,1
            ...#?#???.???? 4,1
            .#?????#.?##??? 1,1,3,3,1
            .??#????###?????? 3,8,1
            ?.???#??????????#??? 4,9
            .##?????#?? 5,1
            ??.????#?????.?.. 1,10,1
            .??#?#?????..#.?.??? 2,3,1,1,1,2
            ??????#???? 2,3,2
            ??#??????#?????# 6,1,1,4
            ???????.?#.??#?# 2,2,2,1,1
            ?#.????#?? 2,6
            ??#????????.. 5,1,2
            ?????#????#??#?.?#?. 8,5,3
            ??##????#?..? 5,3
            .?????.????#? 3,4
            ...?.?????????#???. 1,8
            #?????#??.. 7,1
            .??#????????? 4,1,1,1
            ?#.??????.???? 2,1,2,1
            #???#?#?#?????????? 9,1,1,1,1
            ??.?.??..??#.?# 2,1,1,3,2
            ?#?#??#???#.????.?? 10,1,2,1
            .???#.?????.? 3,3
            ???#??##??.????#??#? 8,1,1,1,1
            ????..??????#?? 1,2,2
            ?#.?.?#..#??#?.? 2,1,1,5
            ????###.#..? 1,4,1
            .????????? 1,1,1
            ?.?...????? 1,2
            ??#??.??##?? 3,6
            ?.????#??#?.#?? 1,9,2
            ?###??????#.???. 11,1,1
            ?????#.?????? 3,1,1,1
            ?.##..?????.?#..?? 2,1,2
            ??#??#?????..? 4,1,1
            ?##?#?#??.??#. 5,3,3
            .??.#????#???#???? 2,1,7,2
            ?.#???????????????? 1,1,9,3
            .???#????##.? 1,2,2,1
            ?#?.?.???#??#?..?.?? 1,1,6,1,2
            ??#?????????#??? 4,1
            ??????.??###?????.#. 3,1,1,3,4,1
            ?????#.#.?.?#? 5,1,1
            ????####..?#..#?# 7,2,1,1
            #???..??????...#?? 2,1,6,1,1
            ?????#??.? 5,1
            .??#????#? 4,1
            ???.#???.??#? 4,2
            .#????#??#?????? 3,3,1,2
            ?????.??????.???? 1,1,3,1,2
            ?#.##?#?.#####??# 1,4,8
            ??.#????...?### 1,1,1,4
            #??#?#??#?.? 6,2,1
            ????#???#?? 5,1
            #???#?#????##.?.? 13,1
            ?###????#???. 4,6
            ????????##???????. 1,4,2
            #?.????#.???? 1,1,2,2
            .????????#? 1,2,3
            ?????##?#.??##?. 8,4
            ?#??#?#????? 1,1,1,1
            ????#??#?#? 1,5
            #??????#?#??????#??# 4,8,3,1
            ?.?###??.????????? 3,7
            ??#???#?????.?###?? 1,1,2,1,4,1
            ?.??..?.??.????##.?? 2,1,1,6,1
            ??#??????? 1,5
            ???##??##???.#??#?# 8,1,6
            .?.??#?##?#?? 6,1
            ????????##????#?# 1,1,9,1
            ????.#?##?.?? 3,5,1
            ??#??.????..?. 4,3,1
            #??#??????#??? 1,1,1,3
            ###?#.?..#? 5,1,1
            ?????#.??????#?#? 1,2,1,5
            #.???#??#. 1,3,1
            .??#?##????? 6,1
            ?????#????..?? 7,1
            ???#??#?#??#??.??? 1,2,3,2,3
            ??????..#????#??.? 2,1,1,2,4,1
            ?#.##?##??????.? 1,5,1,3,1
            ??#??##????.????# 8,1,1
            ???????#.#??#? 1,3,2,1
            ?##?.?#???#???????? 2,2,3,2,1
            .#??..??.????#? 3,2,1,1
            ???????.??????#.###. 3,3,1,5,3
            ??#.#??#????. 2,4,3
            #.#??#????#??##????? 1,1,2,1,6,3
            ##?#?.#?#.#.??? 5,1,1,1,1
            ??????????##??#.?# 5,2,2,2,2
            ??#.??#?????#?#?? 2,7,4
            ???.???????.??#? 1,3,2,3
            ?#.#??...?#.# 1,1,2,1
            ???#?????#?#???#..## 3,9,2
            #.???????#. 1,7
            .??#????.?.????.?? 2,2,1,1,1,1
            ?????..??. 1,1,1
            ??#.???????#.? 2,5,1
            ?????????? 3,1,3
            #.?.??##??.? 1,1,4,1
            ??.????????#????? 1,2,3,1,3
            .#####????????? 6,1,2
            ##????##?.?#.??? 9,1,2
            ??#??????? 2,1,1
            ????#?????????.?#. 14,1
            ?##???##?.##??. 7,4
            #.?#?##??#?####???# 1,14,1
            .?##?.?????# 4,1,2
            .?#.#?.???# 1,1,2
            .?..???????#?.?# 1,1,6,2
            ??##?#?????##??.???? 6,2,3,2
            ??#??????.??#?? 7,2
            #.?.?..#?.??#?#?#. 1,1,1,1,5,1
            ?.?#???????? 2,4
            ????#??..???#?#?. 1,4,1,1,1
            ???.?????# 2,6
            ???#???##..?????..?? 2,3,3,1
            ??##?##?#???###? 5,7
            .??#??##??#?. 2,5
            .#???#?#?????# 1,11
            ?#?#?.?????.????#?? 2,1,2,1,7
            ??#?????????# 3,1,1,1
            .??.????#? 2,2,1
            ????????#????? 1,7
            ?????.##???#?#? 1,3,3
            ????#..??#??? 1,1,2
            ?#?.?.#???# 2,2,1
            #..??.??????#. 1,2,1,4
            .##?.??#.?#.?? 2,3,1,1
            ..?#???#???###.????? 12,1
            ????.????#? 2,1
            ???#.?.??? 1,1,1
            .??.????.# 1,1,1
            ????.???.?.???##??? 3,1,6
            ??#????.??.? 4,1
            #.?..###?? 1,1,5
            ?????????..#.? 1,3,1,1
            ???.###?#??.?. 1,6,1
            ????????????#?##???? 3,1,9
            ??.??.???? 1,2
            ??#?.?????.???????? 4,5,2,4
            ????#?#.?#####??. 5,7
            ?.#?????#??? 1,3,1
            #????#??.?? 1,1,1
            .??????.????# 3,1,2
            ??#?#?????#?.???#### 10,6
            ?.?????#?..? 1,4
            ???#??.#??#??? 2,5
            ##?#?.#?##??##?????? 4,8,3
            ???#???.??????## 3,1,6
            .???#??.??. 1,3
            .???#?.??.?#??? 1,2,2,1
            ??#?.??#.?#.??##??? 3,2,1,5
            ?###??#???###?#???.? 8,8,1
            ###?.?.???..??.? 3,1,3,1,1
            ?#?.?.##????#???? 1,1,4,2,1
            ???????.?? 1,4,2
            .?#???###??? 1,4,1
            #.????.???#.# 1,1,4,1
            ??#?#????.?#?.? 1,5,1,2,1
            .?#?#?#?##? 4,1,3
            ????????????#?#????? 1,1,8,1,1
            #.????????? 1,2,2
            ?##??.???? 3,1,1
            ????..???.?.###?# 2,2,5
            #?#????##.#?? 5,2,2
            ???.#????##?????..#? 1,1,6,2,1
            .#??.??.?? 1,1,1
            #????#??##??? 1,2,4
            ?#????.??????.? 5,4
            ??.?#???#?..?# 1,5,1
            ?#???????????#???? 4,1,5,1
            ???????#?.? 5,1
            ?#??#?????.#??.#?? 5,1,1,1,3
            ???.??????.?? 3,1,2
            ?.???.#??? 2,3
            ?.#.?????? 1,2,1
            #??#.??.#???. 1,2,3
            #???.#.?.?#?. 1,1,1,2
            ?##??????.?#.?? 2,4,2,1
            .?#??#.?#??????? 4,4,3
            #????.???.??#???#.? 2,1,2,4,2,1
            ?????.?????# 1,1,5
            #???#.#?.?????????? 2,2,2,9
            ?#????????.?#.#? 7,1,1,1
            ##?.????#?.?#??. 3,4,3
            ???##??#????#?????? 11,5
            .??.??#??##.?? 1,7,1
            #??##???#.?.? 5,2,1,1
            ???.??#????##??.?# 2,1,1,6,1
            ??##?#????? 3,3
            #.?#??.????#??# 1,3,1,1,4
            ..##?#??.?#? 5,2
            ??.??#????. 1,4
            ???#?.????? 4,2
            #?..????.?#??#?#?#? 1,3,9
            ????##???#.?#?? 7,1,3
            ?????#???????.?? 1,5
            ??.??.????##??#???? 2,10
            ??#?###?.?# 3,3,2
            ???????#???.??.. 7,1
            ??????????#.#?? 4,1,1,1,2
            ?#?#?#??#??.??##??#. 9,5,1
            ?.##?????.? 2,4,1
            #.???.???#??#?#?#??? 1,1,12
            ?.?.?#???#?#?#.?#. 1,1,1,4,1,1
            ???#?#???##????#??? 6,4,4
            ?.????##..??.## 1,1,3,2,2
            .????#.?.??? 5,1
            ?????..?.??#.?#? 1,2,1,2,1
            ?.??#?????.?#? 1,5,1,2
            .????##?????#?? 1,4,2,3
            ??.??.???.?#?? 1,3,3
            ?.#????.???#??.#???? 1,1,1,6,1,1
            ..#?????????##???## 1,4,4,3
            ###??.##??#?????. 4,2,6
            ?..?#????.??.?? 1,2
            .?#?.#????????.??? 3,1,3,1,1
            ?#?????#?##?.###?#?? 3,7,5
            ##??##??????#??..??? 13,1,1,1
            ..#??.?#????#??? 1,2,6
            ?????#?#?????##?.##? 1,7,1,3,3
            ?##?#?#?##? 6,2
            .??#??..???? 4,2
            .#?##????.???. 1,3,1,1
            ??##??.?#.? 4,2,1
            ???.???#?# 3,2,1
            .????..?##???#??#. 2,10
            ?##?????#??.## 5,2,2
            ??????.??? 3,2
            ??#???..?.??? 1,1,1,2
            #???????#?#?????# 1,1,11
            ?##??????#?.??? 4,1,1,1,1
            ?..??#???#????.?### 9,4
            ?????????????#??.?? 1,1,1,4,2,1
            ??#.#.??????.????? 2,1,1,1,4
            ?.....?????? 1,1
            #???.??##? 3,2
            ???.???.?#? 1,3,1
            ??.???.??..? 1,1,2,1
            #??#???#?#??##??? 4,4,2,1
            .????????. 1,3
            .#?????.???#? 2,1,2
            ?.?.???#..?. 1,2,1,1
            ?###????#.??????? 7,1,1,1,2
            ?##?#????###??.?. 6,3
            ???#?.?#??. 3,1
            ??#???#?.?.? 6,1,1
            ?.??????????? 6,1
            ...???##???.?. 5,2,1
            ???.???.?.???## 1,1,1,1,3
            ???.?##??#? 1,2,1
            ###???.?#??#?? 6,5
            ...?#???.??????#? 3,2
            ??????#?????????? 8,2
            .?????#??#.??.#? 1,5,1,1,1
            ###???#??#??????? 4,4,1
            .????###?# 1,3,1
            ??#????#?#?.??? 1,3,1,1,2
            .#???#?##??#?#?# 1,12
            ##.???#??.??..# 2,1,1,1,1
            ???#.##???? 1,3,1
            ???###???.?.##??.?# 1,7,1,2,1,1
            ?.#.?#?#?..?..? 1,1,4,1
            ???.??.?#?? 1,3
            ??????#???#. 1,3,1,1
            ?????#.#????#??? 5,4,1,1
            .?.????#???. 2,3
            ???.??.?## 3,3
            ?????#?.????#?#? 5,6
            ???#?.???#?? 2,6
            ...?????#.? 1,3
            #???#????#? 1,2,1
            ??##????????###??. 6,1,4
            ??#????#??? 1,3
            ??#???#??????#?#? 7,7
            ??####.?.?? 6,1,1
            .?.?.#?#??.?????? 4,2
            #???..#???.?? 4,3,1
            ??..?#??#???##? 1,6,3
            ??????#?#? 1,1,4
            ?.???#?.???????? 1,3,2,1,1
            ????????##????? 1,5,1
            ????#?#?#???#.?.#? 11,1,1
            ?????#??##??????# 1,3,3,3
            ?.???.?#.????#?#??# 1,1,1,1,8
            .#?#??????#?????. 5,3,2
            .??###?????#??. 3,2,3
            ?????#?##??#??? 1,1,1,2,4
            ??#?.#..????#?.?#? 3,1,6,2
            ?##??.????? 2,3
            ?????#?###??#? 2,8
            .??#?#??.????.? 6,2,1
            ????#?.?#???##??? 1,2,6,2
            ??????..?#..? 2,1
            ?.?????#???????? 1,4,2,1
            #.??????.?????#? 1,2,2,6
            #?.?.??#?.????? 2,1,1,2,3
            ?.????#???#??????.#? 12,1
            ?#????#??#.???#.##? 7,1,1,1,2
            ?#???#????????.?? 5,2,4,1
            ???????????# 3,1,1,3
            .???????.? 2,1,1
            ?#????#???????? 2,1,3,1
            .##.?#??.#.?# 2,1,1,1
            ??#???#???.????. 5,1,1,1
            ..????..?????? 1,3
            #??#??#????.?.# 5,1,2,1,1
            ??#.?#????.. 2,3,1
            ?#.??????? 2,1,1
            ????.?#???#?? 1,2,6
            ????#?#?..?#? 4,1
            ??#?#????#?#????. 8,7""";
}
