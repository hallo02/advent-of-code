package ch.hallo02.adventofcode.year2023.day13;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Day13_2 {

    // too high 36476
    // too low 36276
    // yes 36474
    public static void main(String... args) {

        var blocks = Arrays.asList(puzzle.split("\n\n"));

        long sum = 0;
        System.out.println("Amount blocks " + blocks.size());
        for (String b : blocks) {
            sum += findReflection(b.lines().toList());
        }
        System.out.println(sum);
    }


    static long findReflection(List<String> lines) {
        long columns = calc(lines, 1);
        long rows = calc(transpose(lines), 100);
        if (columns != 0 && rows != 0) {
            System.out.println("-----------------");
            System.out.println(columns + " " + rows);
            System.out.println("-----------------");
        } else {
            System.out.println(columns + " " + rows);
        }
        return columns + rows;
    }

    static void printBlock(List<String> block) {
        block.forEach(b -> System.out.println(b));
        System.out.println();
    }

    static long calc(List<String> lines, long multiplier) {
        // printBlock(lines);
        String firstLine = lines.get(0);
        int lineSize = firstLine.length();        // 9
        int candidateLeft = firstLine.length() / 2; // 4
        int candidateRight = candidateLeft + 1;     // 5
        int nextDiff = -1;
        while (candidateLeft >= 0 && candidateRight < lineSize) {
            if (checkPosInField(lines, candidateLeft)) {
                return (candidateLeft + 1) * multiplier;
            }
            candidateLeft = candidateLeft + nextDiff;
            candidateRight = candidateLeft + 1;
            nextDiff = (nextDiff < 0) ? nextDiff - 1 : nextDiff + 1;
            nextDiff *= -1;
        }
        return 0;
    }

    static boolean checkPosInField(List<String> lines, int posLeft) {
        int matches = 0;
        boolean isItOnlyOneSmug = true;
        for (int l = 0; l < lines.size(); l++) {
            var smugs = checkPosInLine(lines.get(l), posLeft);
            if (smugs == 0) {
                matches++;
            }else {
                if(smugs > 1){
                    isItOnlyOneSmug = false;
                }
            }
        }
        return matches == lines.size() - 1 && isItOnlyOneSmug;
    }

    public static List<String> transpose(List<String> originalList) {
        List<String> transposedList = new ArrayList<>();

        // Determine the size of the transposed list
        int numRows = originalList.get(0).length();
        int numCols = originalList.size();

        // Add empty lists to the transposed list to hold the elements
        for (int i = 0; i < numRows; i++) {
            transposedList.add(new String());
        }

        // Iterate through the original list and add elements to the transposed list
        for (int row = 0; row < originalList.size(); row++) {
            for (int col = 0; col < originalList.get(row).length(); col++) {
                transposedList.set(col,
                        transposedList.get(col) + String.valueOf(originalList.get(row).charAt(col))
                );
            }
        }

        return transposedList;
    }

    static int checkPosInLine(String line, int posLeft) {
        int lineSize = line.length();
        int candidateLeft = posLeft;
        int candidateRight = candidateLeft + 1;

        int leftSize = candidateLeft + 1; // 5
        int rightSize = lineSize - leftSize; // 4
        //left is bigger
        if (leftSize > rightSize) {
            // right == truncated left reversed
            var r = line.substring(candidateRight);
            var l = new StringBuilder(line.substring(candidateLeft - rightSize + 1, candidateLeft + 1)).reverse().toString();
            int notMatching = 0;
            for (int y = 0; y < r.length(); y++) {
                if (r.charAt(y) != l.charAt(y)) {
                    notMatching++;
                }
            }
            return notMatching;
        }
        // right is bigger
        else if (rightSize > leftSize) {
            // left == truncated right reversed
            var l = line.substring(0, candidateLeft + 1);
            var r = new StringBuilder(line.substring(candidateRight, candidateRight + leftSize)).reverse().toString();
            int notMatching = 0;
            for (int y = 0; y < r.length(); y++) {
                if (r.charAt(y) != l.charAt(y)) {
                    notMatching++;
                }
            }
            return notMatching;
        }
        // left and right have equal size
        else {
            var l = line.substring(0, candidateLeft);
            var r = new StringBuilder(line.substring(candidateRight)).reverse().toString();
            int notMatching = 0;
            for (int y = 0; y < r.length(); y++) {
                if (r.charAt(y) != l.charAt(y)) {
                    notMatching++;
                }
            }
            return notMatching;
        }

    }


    static String miniPuzzle = """
            #.##..##.
            ..#.##.#.
            ##......#
            ##......#
            ..#.##.#.
            ..##..##.
            #.#.##.#.
                        
            #...##..#
            #....#..#
            ..##..###
            #####.##.
            #####.##.
            ..##..###
            #....#..#""";

    static String puzzle2 = """
            #.#.##.##.#
            #..#..####.
            #.#####..##
            #.##..####.
            ##.#..####.
            ..#...#..#.
            ##...#....#
            ....##....#
            ##.##.#..#.
            #..#.##..##
            ##.###.##.#
            ...#.#.##.#
            .#.#.#.##.#
            ##.###.##.#
            #..#.##..##
               
            ##.#...#.#.
            ##.##..#.#.
            .#.##......
            ..######..#
            ..######..#
            .#.##......
            ##.##..#.#.
            ##.#...#.#.
            ...##...#..
            ...#.###..#
            #..#######.
            ..#.##.###.
            ..###.##.#.
            ..##.##.##.
            ..#.#..##..""";

    static String puzzle = """
            #.#.##.##.#
            #..#..####.
            #.#####..##
            #.##..####.
            ##.#..####.
            ..#...#..#.
            ##...#....#
            ....##....#
            ##.##.#..#.
            #..#.##..##
            ##.###.##.#
            ...#.#.##.#
            .#.#.#.##.#
            ##.###.##.#
            #..#.##..##
               
            ##.#...#.#.
            ##.##..#.#.
            .#.##......
            ..######..#
            ..######..#
            .#.##......
            ##.##..#.#.
            ##.#...#.#.
            ...##...#..
            ...#.###..#
            #..#######.
            ..#.##.###.
            ..###.##.#.
            ..##.##.##.
            ..#.#..##..
                        
            #.....###..###.
            .###....#..#...
            .#..#.#..##..#.
            ##.##.#..##..#.
            .#....#.#..#.#.
            .###.#..#..#..#
            #.###..######..
            #..#...######..
            ..#.##.##..##.#
            ..#.##.##..##.#
            #......######..
                        
            .##.#######
            .##....##.#
            #..#.#.#.##
            #####....##
            ####.....##
            #..#.#.#.##
            .##....##.#
            .##.#######
            ####.#.###.
            #..#####..#
            ......#####
            ........###
            #..###.###.
                        
            #..##..
            #..#...
            ###.#..
            ##..###
            ####.##
            ..#.#..
            ..#.###
            .##.##.
            .##.##.
            ..#.###
            ..#.#..
                        
            ##.##.#####
            #.####.#.##
            ..#..#....#
            #########..
            ########.##
            ...##...#.#
            .#....#...#
            ########..#
            ..####.....
            #......###.
            #......###.
            ..####.....
            ########..#
            .#....#...#
            ...##...#..
            ########.##
            #########..
                        
            ...#.#..#....#.
            #.##..##.####.#
            .##.#.##.#..#.#
            #.#.#..##.##.##
            ..#.######..###
            ...#.###......#
            .##...##......#
            ##..#.##.####.#
            .###......##...
            ##..#..#..##..#
            ####.#..##..##.
            .###..#.######.
            #....##...##...
            #.....#...##...
            .###..#.######.
                        
            #..####
            .##.#..
            .##.#.#
            #..####
            #..####
            .##.#.#
            .##.#..
            #..####
            .##...#
            #..###.
            ..###..
                        
            ##.##.....#.#
            ##.##.......#
            ......#.##...
            ##.#.#..#.#..
            ##.#..#######
            ##...###..#..
            ##.##.#..#.##
            ####.#...#..#
            ###.....####.
            ...##....#...
            ...##.#.##.##
            ....#..#...##
            ###...#......
                        
            #####.##..#
            #.#..######
            .#.#...####
            .#.#...####
            #.#..######
            ###.#.##..#
            ...#.######
            ##.#...####
            ....#..####
            .#.#....##.
            .....#.#..#
                        
            .#....#.#..##
            .#....#....##
            ..#..#.......
            .##..##...###
            ##########..#
            .#.##.#.###.#
            ..#..#...#.##
            #.####.##..#.
            .#....#..##..
            #......###.##
            .#.##.#..###.
            ...##...####.
            .#....#...#..
            ##.##.####.##
            ##....##...##
            #.####.####..
            ###..#####.##
                        
            .##.####....#
            .##.#..####.#
            #####...#.###
            .......#.....
            ####.#...##..
            .##....####.#
            .##....######
            .##....######
            .##....####.#
            ####.#...##..
            .......#.....
            #####...#.###
            .##.#..####.#
            .##.####....#
            .###..#...##.
                        
            #####.#.#.#..#.#.
            #..###.###.##.###
            ....#...#..##..#.
            #..####..#....#..
            #..###..#.####.#.
            #####.#.#..##..#.
            #####.#.#####.##.
            .##..###..####..#
            #..#.#..########.
            #..##.#####..####
            ####...#..#..#..#
                        
            ########.....
            ...##.....##.
            .........####
            #.#..#.#####.
            #.#######..#.
            #.####.#.#..#
            ###..#####.#.
            #.#..#.#..##.
            ..####....#.#
            ..####...#...
            #.#..#.#.#..#
            #.####.#.....
            #.####.#.....
                        
            ###....#.##.#.#
            ..#....#....###
            #####.#..#.#.##
            ##.#.#..##..#..
            ..###..##...#..
            #####.##...####
            .....#...##.##.
            ###....####..##
            ##.###.##.###..
            ..##.####.#...#
            ###.##...#..###
            ..##.#..##.#...
            ..##.##.##.#...
            ###.##...#..###
            ..##.####.#...#
                        
            .#......#.#######
            ............####.
            ....##.....##..##
            .###..###........
            ....##....#..##..
            ##.#..#.##.######
            ...####...#######
            ..######..##.##.#
            .########..#.##..
            ###....#####.##.#
            #...##...##......
            ...#..#...#..##..
            ##.####.##.......
            .##....##.#..##..
            #.##..##.#.#.##.#
            .#.#..#.#.##.##.#
            .##.##.##.##.##.#
                        
            ....#.#.#..#.#.
            ####.#..#.#.#..
            #..##.#.#..####
            ####..###......
            ....###.#.###..
            ....#.##....#.#
            #..##.###.####.
            ....##.#...#...
            #..#.#.#.#..###
            ####.#.#...##..
            ####.#.#...##..
            #..#.#.#.#..#.#
            ....##.#...#...
            #..##.###.####.
            ....#.##....#.#
            ....###.#.###..
            ####..###......
                        
            ..#####....#####.
            ##..##########..#
            .##.#..####..#.##
            ..######..######.
            ..######..######.
            .##.#..####..#.##
            ##..##########..#
            ..#####....#####.
            .....########....
            ..#..##....##..#.
            .###.##.##.##.###
            .#.#####..#####.#
            ..#....#..#.#..#.
                        
            .###.##.###
            .###.##.###
            ####....#.#
            #...####...
            ####....###
            .#...##...#
            ..###..###.
            #..#.##.#..
            #....##....
                        
            #.#.#.#....#.
            ###..##.##.##
            ...##.#....#.
            ..##.#.####.#
            ##.#.#.#..#.#
            .#..##..##..#
            #.#...#....#.
            ...##.#....#.
            ...##.#....#.
            #.#...#....#.
            .#...#..##..#
            ##.#.#.#..#.#
            ..##.#.####.#
                        
            #......
            .#.####
            #.#####
            .##...#
            ..#....
            ###.##.
            ##.####
            .#..##.
            .##....
            ##..##.
            ##..##.
                        
            ##..#.#..#..###
            ##.#......#....
            ####....#.#####
            .#.##.##.......
            #..#.#..####..#
            #..#.#..####..#
            .#.##.##.......
                        
            .#..###.#
            ..#...##.
            #####.#.#
            ....#.###
            #.###.#.#
            ###.####.
            ##..#..#.
            .#.#.....
            .#.#.....
            ##..#..#.
            ###.####.
            #.###.#.#
            ....#.###
            #####...#
            ..#...##.
            .#..###.#
            .#..###.#
                        
            #.#.#.....###.##.
            #.#.#.....###.##.
            #...#.#.#####..#.
            ..#....#.####....
            #.#.##.##..###..#
            #.#....#.#.#.####
            .##.#####........
            .#.#.##..#####..#
            .#.......#.######
            ..##.###.##.#####
            ####.#..##..#....
            ##..#.#.##.##.##.
            #.#..#.#....##..#
                        
            #...#.####.#.#.##
            #..#.#.#..##..#.#
            .###...###..#....
            ####..###.###..##
            ##..##...###.##..
            #.#.##.##..#.#..#
            #.#.##.##.##.#..#
            .##.#.##...###...
            .##.#.##...###...
            #.#.##.##.##.#..#
            #.#.##.##..#.#..#
                        
            ..........##.
            .##.#.#.####.
            ####..###.###
            ####.#..#..##
            .##.##.#...#.
            ....####...#.
            .##...###..##
            ####.###.#.##
            ....###.#...#
            #..#.##....#.
            #..#.##.#..#.
                        
            .###...#.....
            .###...#.....
            ..####.#####.
            ...#.##.##.##
            #.###...###..
            ####.#.#.###.
            #.#.#.##...##
            #.#.#.##...##
            ####.###.###.
            #.###...###..
            ...#.##.##.##
            ..####.#####.
            .###...#.....
                        
            .###..#.#
            .#.#..#.#
            .#.###..#
            ##....###
            ##....###
            .#.###..#
            .#.#..#.#
            .###..#.#
            ..###.#.#
            .##.#.#.#
            ####..###
            ###..##.#
            #.#.###.#
            ###..####
            #.#.#.#.#
            ......#..
            #..#####.
                        
            #...#..#..###..##
            .#.##.#.##.......
            .##.#.#...#......
            #..#.#...###.##.#
            #.#...###.#######
            ####.##..#...##..
            ##..#.####.######
            ..#.#..#.####..##
            ...######.###..##
            ####....###......
            .#####.#.##..##..
            .##..#..#........
            ####...###...##..
                        
            ###.##..#
            ###.##..#
            ###.####.
            ##..#####
            #....#..#
            #..##.##.
            ..#..####
                        
            ####......#######
            ####..##..#######
            .##.#.##.#.##..##
            ###...##...######
            ..##..##..##.....
            .#..#....#..#..#.
            ####..##..#######
            #..###..###..##..
            .####.##.####..##
            .#..........#..#.
            #..#..##..#..##..
                        
            ....#..#..#..#..#
            ....#..#..#..#..#
            #.#.#.###.#..#.##
            ..#..###...##...#
            .#......##....##.
            ##..#...#.#..#.#.
            #.#######.##.#.##
            ##...##.#..##..#.
            ####..#..######..
            .##..#..##.##.##.
            ...#...#..####..#
            #####.###......##
            .#####.#.######.#
            .#.....#.#.##.#.#
            .###.......##....
            .#...#....#..#...
            .#.#..##..#..#..#
                        
            ###...###
            ..#.#.#..
            #.#...#.#
            ###.#.#.#
            ...##.#..
            ####..#.#
            ..#..#..#
            ###....#.
            ....#.#..
            ....#.#..
            ###....#.
                        
            ..#..###.##
            ##.##.###..
            ..##....##.
            ..##..##.##
            ##..##.####
            #####.#....
            ##.#....###
                        
            .#.#.##.#..
            #....#.##..
            #.#.###.###
            #.##.###.##
            .#.##...###
            #..........
            ...##....##
            #...#......
            ###.#.#....
            ###.#.#....
            #...#......
            .#.##....##
            #..........
            .#.##...###
            #.##.###.##
                        
            ..####...#.####.#
            #......##..#..#..
            #.#..#.#####..###
            ##....#####.##.##
            ..####......##..#
            ..#..#..#.#.##.#.
            #..##..##.######.
            ..####..###....##
            ###..#######..###
            .#.##.#.#..#..#..
            .######.##.#..#.#
                        
            ..##..###..
            ..#####....
            ...#.#.#.##
            ...#.#.####
            ..#####....
            ..##..###..
            ##......##.
            ##.#..#.###
            ###..##....
            ...##..##.#
            ##.###.#.#.
            ###.#.#....
            ..##...#..#
            ####.###.##
            ....#..#.##
                        
            #....##....
            ..##....##.
            #.##....##.
            .#...##...#
            #..........
            #####..####
            #....##....
                        
            ..#..#.
            ##.#.##
            #..#...
            #...##.
            ...#...
            ...#...
            #...##.
            #..#...
            ##.#.##
            ..#..#.
            ....#..
            #.#..##
            ##....#
            ...#...
            ...##..
                        
            .####.####.
            .###.......
            ..#####..##
            ...#.##..#.
            #.#.###..##
            .#..##....#
            ..#....##..
            #.#.#.#..#.
            #.#.#.#..#.
                        
            ...#..####....#..
            ....#.###...##...
            ###....#...#.#...
            ...###...##....##
            ##.##..#..###.#..
            #..#.#...#.#...##
            ..#....#...#..#..
            ..#....#...#..#..
            #....#...#.#...##
            ##.##..#..###.#..
            ...###...##....##
            ###....#...#.#...
            ....#.###...##...
            ...#..####....#..
            ....#..###.#..###
            #.....###....##..
            ....####....##...
                        
            #.#.#.#..#.#...#.
            #..#.#.#..#...###
            ##.#..#.#.....#.#
            ###..#..#..#...##
            ##..#....#...#.#.
            .##.#....#...##..
            .##......#...##..
            ##..#....#...#.#.
            ###..#..#..#...##
            ##.#..#.#.....#.#
            #..#.#.#..#...###
            #.#.#.#..#.#...#.
            .####...#..##.#..
            ####.##.#####.##.
            .####.#####..#.#.
            #...###.......###
            #...###.......###
                        
            .#.##.#..##...#
            ###..###.##.#..
            #.####.##..#.##
            #.#..#......#..
            #.#..#......#..
            #.####.##..#.##
            ###..###.##.#..
                        
            ...#.##.##.##.#..
            ##....######....#
            ##..#.##..##.#..#
            ###.#.######.#.##
            ..#...#.##.#...#.
            ...#.#.####.#.#..
            ..###.##..##.###.
            ....#...##...#...
            ..#..##....##..#.
            .#.#.#..##..#.#.#
            ##....#.##.#....#
            ##.#####..#####.#
            ##....#....#....#
            ...###.####.###..
            ..#####....#####.
            ##...#.####.#...#
            ########..#######
                        
            ####.##...##.##.#
            #..##.######..#..
            #..##.######.##..
            ..#.#..##########
            .#.#..#.###.##.##
            #.#.#..##...###.#
            #....#..#.#.#....
            #....#..#.#.#....
            #.#.#..##...###.#
            .#.#..#.###.##.##
            ..#.#..##########
            #..##.######.##..
            #..##.######..#..
                        
            ##.#..#
            ######.
            .#..#..
            .....##
            .....##
            .#..#..
            ######.
            ##.#..#
            .###.#.
            ..#.##.
            ....##.
            .###.#.
            ##.#..#
                        
            ##....###.#..##..
            .#...##.##.##..##
            #...##.###..#..#.
            #..####...#######
            #..####.#.#######
            #...##.###..#..#.
            .#...##.##.##..##
            ##....###.#..##..
            ###.#.###..#....#
            #...##.#..#..##..
            ......#..#..#..#.
            .#.....##...#..#.
            ..#...##.##......
                        
            .####.#
            ...#.##
            #...###
            #.##...
            .##....
            ....#..
            .#..#..
            .....##
            .##..##
            #...###
            #...###
                        
            ##.#.##
            #..#.#.
            #.#..##
            #.##.##
            ##..#..
            ..#.###
            .#.####
            .#..###
            .#..###
                        
            #.##..###.#
            ...####.##.
            .#.###.###.
            #.....###..
            ..####.####
            ....#..#.##
            ....#..#.##
            ..####.####
            #.....###..
            .#.###.###.
            ...####.##.
            #.##..###.#
            #.##..###.#
            ...####.##.
            .#.###.###.
            #......##..
            ..####.####
                        
            .###...#...##
            ..##.#...#..#
            ....#.##.####
            ..#....###.#.
            ..###.##.####
            ..####..#...#
            ..##..#...#..
            .......##..##
            ...#.#.####..
            ###.#.##.##..
            ..#.###.#.#.#
            ####.....#.##
            ###...#####.#
            ...#####.####
            ##.#.#####.##
            ##.#.#####.##
            ...#####.####
                        
            #..###.#..##.
            .....#.....##
            ####....####.
            ....#.....###
            #####.##.#.#.
            .##..#####.##
            .....##..####
            #######..#.##
            .##..##..#...
            #####.#..###.
            #..#.###..###
            #..#.###..###
            #####.##.###.
            .##..##..#...
            #######..#.##
                        
            ..#..##.....#
            ###.#.##.###.
            #.###.#######
            ####.#..#....
            ####.#..#....
            #.###.#######
            ###.#.##.###.
            ..#..##.....#
            #.######..##.
            .#.##....##..
            ##.#.....##..
            ##.#.....##..
            .#.##....##..
            #.######..###
            ..#..##.....#
                        
            ........####...#.
            ........####...#.
            #...######.##.##.
            .####.##.#...##.#
            ##..###.#......##
            #....##.###.#....
            #######....#.#.##
            .####.#..#.###..#
            .####.##...#.##.#
                        
            #####.#.#
            #..##.##.
            .....#...
            #####..#.
            .##.....#
            ....#.###
            ....#.###
            .##.....#
            #####..#.
            .....#...
            #..##.##.
            #####.#.#
            .##..#...
            ..#...#..
            .##.##..#
            ....##...
            ####...#.
                        
            ###....
            #.###.#
            ###...#
            .#.#.##
            ###.###
            ###.###
            .#.#.##
            ###...#
            #.###.#
            ###....
            .#####.
            #..#...
            .####.#
            .####.#
            #..#..#
            .#####.
            ###....
                        
            ......#..####..#.
            ##..##.#.####.#.#
            ..##...##....##..
            ......#..####..#.
            #.##.##..#..#..##
            ##..##.#.####.#.#
            .........#####...
            .#..#..###..###..
            #....###..##..###
            #######........##
            #########....####
            ########..##..###
            .......##.##.##..
            ######.##....##.#
            ......###....###.
            ......#..####..#.
            ##..##.#..##..#.#
                        
            ..#..####..#.
            ..#..#..#..#.
            ##.##....##.#
            ...########..
            ###..###...##
            ##.##....##.#
            ..#..####..#.
            ##....##....#
            ..##########.
            ##.########.#
            ...##.##.##..
                        
            ..####..####..##.
            .###.####.###.##.
            ##.##....##.##..#
            .####....####....
            #.#.#.##.#.#..##.
            #####.##.########
            #...#....#...#..#
                        
            ..##..#.##.##.##.
            ..##..###########
            #....#..##.##.##.
            .####.##.##..##.#
            ##..##..########.
            ######.##..##..##
            #....##..#.##.#..
            #....###..#..#..#
            .....##.##....##.
                        
            .....#...##..####
            .....#...#...####
            .....#...#...####
            .....#...##..####
            .#..####...#...#.
            #########.##..###
            #####.##...##.#.#
            ..#.#.##.##...##.
            ....###..##.##.##
            #.###..##.#..##.#
            .....########..##
            ##..###.##..#####
            .####.#.#..#...##
            ##..#..#.###.#.#.
            #.##...##.#.....#
            .#.#.....#.......
            #...#####.######.
                        
            #......###.##.#
            .##.##.#.#.##.#
            ######...######
            .###.###..####.
            ###..####..##..
            ###..####..##..
            .###.###..####.
            ######...######
            .##.##...#.##.#
            #......###.##.#
            #.#####..##..##
                        
            #.##.#.#...
            ..##..##...
            #.##.#.####
            .#####.....
            #....##..##
            ..##.......
            .####......
            #....#.#.##
            ##..###.#..
            .####.#.###
            ..##..#....
            #....#.....
            .####.###..
                        
            #..###..#.####..#
            #####.##..##..##.
            ####.#.##....##.#
            ####....#....#...
            .##...#..####..#.
            #####..#......#..
            #..#.....####....
                        
            #####.#..##.##.
            ........#......
            ......##.###...
            #####....#..#.#
            .##....#######.
            ####.#..#.##...
            .##.#.######.##
            ....#....###..#
            #..#####....##.
            .##.##..######.
            ......#.#.##.#.
            ####..#..####..
            .##...#..##..##
            #..##.#.###.#.#
            #..###..#..#.##
            .##.#..##..#.#.
            .##.#...#..#.#.
                        
            .#.#..#.#.##.#.
            ##########..###
            ####..####..###
            .###..###.##.##
            ##############.
            #.##..##.####.#
            ##..##..######.
                        
            ##..#.####.#.
            ....#.#..#.#.
            ....#.#..#.#.
            ##..#.####.#.
            .##.#..##..#.
            .#.#.#.##.#.#
            #.#.#......#.
            #..######.###
            ..#.##....##.
            .#.####..####
            ....#..##..#.
                        
            ....#####....
            #######.####.
            .#####.##..##
            #.##.#..#..#.
            #.###.#..####
            ..#...##.####
            .#.#..#.#####
            .#.#..#.#####
            ..#...##.####
            #.###....####
            #.##.#..#..#.
            .#####.##..##
            #######.####.
            ....#####....
            ....#####....
                        
            .......##
            .##..##..
            .##..##..
            .......##
            #....##.#
            #..##.#.#
            #####...#
            ####..###
            ....#.#..
            #..#..#.#
            ........#
            #####.###
            ....#..#.
                        
            #...##.
            #....##
            #####..
            #.###.#
            .###..#
            .#.#..#
            #.###.#
            #####..
            #....##
            #...##.
            #...##.
                        
            #.......####..###
            .#.#..#.#........
            ##.#..#.####..###
            ...####...#....#.
            #.#....#.#......#
            #...##...#..##..#
            ##.####.##......#
            ###....###..##..#
            .########.##..##.
                        
            #..#...####
            #..##.#####
            #..##.#..#.
            #..##.#..#.
            #..##.#####
            #..#...####
            ##########.
            .....#..#..
            #..#.#.#.##
            #...#.#.##.
            #..#.#.###.
            ....####...
            .....#.#..#
            .....##.##.
            .##.##.##.#
            .....######
            .##.#..##..
                        
            ##.#....#..#.#.
            ####.##.#...##.
            ..##..###.##.##
            ........##..##.
            ...###.#..#...#
            ..#.##..#.#####
            ..####..##.####
            ...#...##.#.#..
            ..###.###.#....
            ##...##.#.#....
            ###..#.###...##
            #####..####.##.
            ...#...##.#.###
            ..#....########
            ...#.#######.##
            ..##.#.#...##..
            ..##.#.#...#...
                        
            ..#.##.#...
            .#.#.......
            ########.##
            ..#..###..#
            ....#..###.
            ....#..###.
            ..#..###..#
            #######..##
            .#.#.......
            ..#.##.#...
            .#.#.#.#.##
            .#...#.#.#.
            #####.#.##.
            ##...###..#
            ##...###..#
                        
            .#.....###.#.....
            #.###...#.#......
            ...#...##....#..#
            ...#...##....#..#
            #.###...#.#......
            .#......##.#.....
            #.#..########....
            ..##.##.#####.##.
            #...##.#.##.#.##.
            #....#..#....#..#
            .#.###.##...#####
            ...##..#.........
            .#..####.##.#....
            ......#.##...####
            #..#######..#.##.
                        
            ..##...#.#..#.#
            ...#.#.#......#
            .##..###......#
            .##..##.#....#.
            #.#...##..##..#
            #..#..###.##.##
            #.##..#.##..##.
            ####..##......#
            #.###.##.####.#
            ####.#..#....#.
            .####..#......#
            ...##.##.####.#
            #.####.#..##..#
            .##.####..##..#
            ..#.####..##..#
                        
            .##..###..#.....#
            .##.###.....#.##.
            .##.###.....#.##.
            .##..#.#..#.....#
            .##......###..#.#
            #..#.###.###..##.
            ......####.####.#
            #..#.####..#..#..
            .##.....##.##.###
                        
            ....##...
            ##.####.#
            ##..##..#
            ##.####.#
            ##......#
            ####..##.
            ###.##.##
            ##......#
            ###....##
            ...#..#..
            ##..##..#
            ...#..#..
            ..######.
            ###....##
            ##.####.#
            ...####..
            ..######.
                        
            .#....#..
            .##..##..
            .######..
            #.#..#.##
            #...#..##
            #.####.##
            #..##..##
            .##..##..
            .#.##.#..
            .#....#..
            .##..##..
            #.#..#.##
            ##....###
            ###..####
            .#....#..
                        
            .....#.##.#
            ........#.#
            ...###..###
            #.#.###.#.#
            ...#.#....#
            ..#.##.###.
            ..###....#.
            ###.##.###.
            ###.##.###.
                        
            ..###.#..#.###...
            ..###......###...
            #....#....#....##
            .#..#.####.#..#..
            #.##..#..#..##.##
            ...#.######.#..##
            ....##....##.....
            ...##########....
            ##..###..###..###
            #.#.#......#.#.##
            .#.##########.#..
            #..###....###..##
            ..#....##....#...
                        
            .#....##.##..##.#
            .#.####.#..##..#.
            .#.##..#........#
            ..##.###..#..#..#
            ..#...###.#..#.##
            #..#...##.####.##
            #.#...#.###...##.
            ##.##..###.##.###
            ...#.##..........
            ...#.##..........
            ##.##..###.##.###
                        
            .###.##.###.#..##
            ..#.#..#.#...##.#
            ....#..#.....#.#.
            ..##....##..#.#.#
            ..##....##..#.#.#
            ....#..#.....#.#.
            ..#.#..#.#...##.#
            .###.##.###.##.##
            #....##....#####.
            .##......##.#.##.
            .##......##..###.
            .##.#..#.##.###.#
            #####..#####.####
            ...######...#.#.#
            #..##..##..##.###
                        
            .....#.....
            ..#.#.#####
            ###..##....
            ##..#.#.##.
            ..######..#
            ...#..#....
            #####..####
            ##.#....##.
            ...#..##..#
            ####.#..##.
            ##..##.....
            ...##.##..#
            ..###..#..#
            #####...##.
            ......##..#
            ###...##..#
            ....#.##.##
                        
            ..####.#.#....###
            ##...##..###.##.#
            ###.##.#..#....#.
            ###.##.#..#....#.
            ##...##..###.##.#
            ..####.#.#..#.###
            .......######.#..
            ..#.##.....#.....
            ..#.##.##.#.####.
                        
            ##..#.#.###.#
            ##..#.#.###.#
            #.#..###..##.
            ...#.#...##.#
            ###.#.##..#.#
            .#..####.#.##
            .#####.##..#.
            .######.#####
            #..........#.
            #..........#.
            .######.#####
            .#####.##..#.
            .#..####.#.##
            ###.#.##.##.#
            ...#.#...##.#
                        
            ...##.##.#.####
            .#.#...#..#.##.
            .#..#..####....
            #####.#.#.##..#
            .....###.#.#..#
            ......##.#.#..#
            #####.#.#.##..#
                        
            #....######..##
            #####.....#.#..
            ..##..#.#..#.##
            ..##..##..###..
            ..##.....##.###
            #....###.###.##
            ##..##.#.#.##..
                        
            ##..##.###..###
            ##..##.###..###
            ......#.####..#
            ..##.###.#.####
            #....###...#.##
            ##..####..#.#..
            .####.#.....#.#
                        
            ###.####.##.#
            ........#..#.
            ..####.......
            ##....##....#
            #.#..#.#.##.#
            ##.##.###..##
            ##.##.##....#
            #.####.#....#
            .#.##.#..##..
                        
            ####....#.#..###.
            .##.#..##...#..##
            .##.#..##...#..##
            ####....#.#..###.
            #####.#.#.##.....
            ..#.....#....###.
            #..#.#...##.#..##
            #..#####.##...#.#
            ######.#...#.#...
                        
            .#..#.#...#..
            ##..##.####..
            ..##...#..#..
            .#..#...#..#.
            .####....##..
            #....##..####
            .####.#.###..
            ......#.##.##
            ..##..#...#..
            #....#.####..
            ..##....#####
                        
            #...#.#..##.#
            #...#.#..##.#
            ###..##......
            #########...#
            .#..#.#.##...
            #..####...#..
            #..##..#..##.
            #....##.....#
            #....##.....#
            #..##..#..##.
            #..####...#..
            .#..#...##...
            #########...#
            ###..##......
            #...#.#..##.#
                        
            #.#...#
            ...####
            #.#.#..
            ####...
            #....##
            ##.##..
            ##.##..
                        
            .##......##..
            #..#.....##..
            ....##...##..
            #..#.#...##..
            #..##.#.####.
            #..#.#...##..
            .##...#..##..
            #..###.##..##
            ....##.#....#
            ....#.....#..
            #..#.##.####.
            ######...##..
            ####..#.#..#.
            ....#####..##
            .##.#.##....#
            #..##.#......
            #..#.###....#
                        
            ...#....#....#.
            #.#......#.#..#
            .#...##...#.#..
            #.###..###.#...
            #.#......#.##.#
            ##...##...#..#.
            .#..#..#..#....
            #..........#.#.
            .#.#.##.#.#.#..
            .#.#.##.#.#.#..
            #..........#.#.
                        
            ##.####.##.####.#
            ..#.##.####.##.#.
            .#.####.##.####.#
            #..#..#....#..#..
            #..#..#....#..#..
            ##.#..#.##.#..#.#
            #.##..##..##..##.
            ####..######..###
            ###.##.####.##.##
            ....##......##...
            #.##..##..##..##.
            #...##......##...
            #.##..##..##..##.
                        
            #....#####.##..##
            ......#..##.#####
            ########.#.###.##
            #.##.###.......##
            ..##...##..##....
            ......####.#.####
            .......#..###....
            ####.#.#.###...##
            ###########..#...
            .........#...#.##
            ......#.#....#...
                        
            .##.##.#.
            #.#.##.##
            #.......#
            #.......#
            #.#.##.##
            .##.##.#.
            .###..###
            #..#..##.
            .#.####..
            ####.....
            #....#...
            ....#...#
            .####.###
            .#...#...
            #.#######
            #...#..##
            #.#.#..##
                        
            .##.#####..
            ..#.#.##...
            ###.###.#..
            ###.##...#.
            .#.#...##..
            ...#...#.#.
            ##.###....#
            ##.##.....#
            ...#...#.#.
            .#.#...##..
            ###.##...#.
            ###.###.#..
            ..#.#.##...
            .##.#####..
            ..#......##
            ##.#.#####.
            ##.#.#####.""";
}

